(function(){"use strict";var e={7114:function(e,t,o){var n=o(3751),a=o(641);const i={id:"app"};function s(e,t,o,n,s,r){const c=(0,a.g2)("WhiteCubeRoom");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(c)])}function r(e,t,o,n,i,s){const r=(0,a.g2)("ThreeJSScene"),c=(0,a.g2)("UploadMenu");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(r,{ref:"threeScene"},null,512),e.isMobile?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[0]||(t[0]=(...e)=>s.toggleUploadMenu&&s.toggleUploadMenu(...e))},"Upload Files")):(0,a.Q3)("",!0),i.showUploadMenu?((0,a.uX)(),(0,a.Wv)(c,{key:1,onUpload:s.handleUpload},null,8,["onUpload"])):(0,a.Q3)("",!0)])}o(4603),o(7566),o(8721);const c={ref:"threeContainer",class:"three-container"};function d(e,t,o,n,i,s){return(0,a.uX)(),(0,a.CE)("div",c,null,512)}o(4114),o(6573),o(8100),o(7936),o(7467),o(4732),o(9577);var h=o(9437),l=o(9318),u=o(2763),w=o(7070),p=o(3487),m=o(9702),f=o(6998),v=o(9502),b=o(5048),g=o(712),y=o(2393),k={name:"ThreeJSScene",data(){return{move:{forward:!1,backward:!1,left:!1,right:!1},touchStart:{x:0,y:0},objects:[],canvas:document.createElement("canvas"),ctx:null,frames:[],frameIndex:0,playing:!0}},mounted(){this.initThreeJS(),this.loadObjects()},methods:{initThreeJS(){const e=this.$refs.threeContainer,t=new h.Z58,n=new h.ubm(75,window.innerWidth/window.innerHeight,.1,1e3);n.rotation.order="YXZ";const a=new h.JeP;a.setSize(window.innerWidth,window.innerHeight),e.appendChild(a.domElement);const i=new h.$p8(16777215);t.add(i);const s=new h.fTw(20,20);t.add(s);const r=new h.IzY(5);t.add(r);const c=new h.iNn(10,10,10),d=new h.V9B({color:16777215,side:h.hsX}),u=new h.eaF(c,d);t.add(u);const w=new h.Tap;w.load(o(852),(e=>{const o=e.image.width/e.image.height,i=4,s=i/o,r=new h.bdM(i,s),c=new h.V9B({map:e,transparent:!0,side:h.$EB}),d=new h.eaF(r,c);d.position.set(0,2,0),t.add(d);const l=()=>{requestAnimationFrame(l),this.move.forward&&p.moveForward(.1),this.move.backward&&p.moveForward(-.1),this.move.left&&p.moveRight(-.1),this.move.right&&p.moveRight(.1),d.rotation.y+=.01,a.render(t,n)};l()}));const p=new l.Z(n,a.domElement);this.controls=p;const m=()=>{console.error("Pointer lock error occurred.")};document.addEventListener("pointerlockerror",m),document.addEventListener("click",(()=>p.lock()));const f=this.move,v=e=>{switch(e.code){case"ArrowUp":case"KeyW":f.forward=!0;break;case"ArrowDown":case"KeyS":f.backward=!0;break;case"ArrowLeft":case"KeyA":f.left=!0;break;case"ArrowRight":case"KeyD":f.right=!0;break}},b=e=>{switch(e.code){case"ArrowUp":case"KeyW":f.forward=!1;break;case"ArrowDown":case"KeyS":f.backward=!1;break;case"ArrowLeft":case"KeyA":f.left=!1;break;case"ArrowRight":case"KeyD":f.right=!1;break}};document.addEventListener("keydown",v),document.addEventListener("keyup",b);const g=e=>{this.touchStart.x=e.touches[0].clientX,this.touchStart.y=e.touches[0].clientY},y=e=>{const t=e.touches[0].clientX-this.touchStart.x,o=e.touches[0].clientY-this.touchStart.y;n.rotation.y-=.002*t,n.rotation.x-=.002*o,n.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,n.rotation.x)),this.touchStart.x=e.touches[0].clientX,this.touchStart.y=e.touches[0].clientY};document.addEventListener("touchstart",g),document.addEventListener("touchmove",y);const k=()=>{requestAnimationFrame(k),this.move.forward&&p.moveForward(.1),this.move.backward&&p.moveForward(-.1),this.move.left&&p.moveRight(-.1),this.move.right&&p.moveRight(.1),a.render(t,n)};k(),window.addEventListener("resize",(()=>{n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight)})),n.position.set(0,2,5),this.scene=t,this.camera=n,this.renderer=a},async addImage(e){const t=new h.Tap,o=e.split(".").pop().toLowerCase();"gif"===o?this.loadGIF(e):t.load(e,(async t=>{const o=t.image.width/t.image.height,n=new h.bdM(2,2/o),a=new h.V9B({map:t,side:h.$EB}),i=new h.eaF(n,a),s=5,r=new h.Pq0(0,0,-s);r.applyQuaternion(this.camera.quaternion),i.position.copy(this.camera.position).add(r),i.lookAt(this.camera.position),this.scene.add(i),this.objects.push({type:"image",url:e,position:i.position.clone(),uuid:i.uuid}),await this.saveObjects()}))},async loadGIF(e){const t=await fetch(e),o=await t.arrayBuffer(),n=(0,y.O5)(o);this.frames=(0,y.Ud)(n,!0),this.canvas.width=this.frames[0].dims.width,this.canvas.height=this.frames[0].dims.height,this.ctx=this.canvas.getContext("2d");const a=new h.GOR(this.canvas),i=this.canvas.width/this.canvas.height,s=new h.bdM(2,2/i),r=new h.V9B({map:a,side:h.$EB}),c=new h.eaF(s,r),d=5,l=new h.Pq0(0,0,-d);l.applyQuaternion(this.camera.quaternion),c.position.copy(this.camera.position).add(l),c.lookAt(this.camera.position),this.scene.add(c),this.objects.push({type:"image",url:e,position:c.position.clone(),uuid:c.uuid}),await this.saveObjects();const u=()=>{requestAnimationFrame(u),this.renderFrame(),a.needsUpdate=!0};u()},renderFrame(){const e=this.frames[this.frameIndex],{dims:t,patch:o}=e;this.ctx.putImageData(new ImageData(new Uint8ClampedArray(o),t.width,t.height),t.left,t.top),this.frameIndex=(this.frameIndex+1)%this.frames.length},async addAudio(e){const t=new Audio(e),o=new h.iNn(.5,.5,.5),n=new h.V9B({color:65280}),a=new h.eaF(o,n),i=5,s=new h.Pq0(0,0,-i);s.applyQuaternion(this.camera.quaternion),a.position.copy(this.camera.position).add(s),a.userData={onClick:()=>t.play()},this.scene.add(a),this.objects.push({type:"audio",url:e,position:a.position.clone(),uuid:a.uuid}),await this.saveObjects()},async addModel(e,t){let o;switch(t){case"gltf":case"glb":o=new u.B;break;case"obj":o=new w.L;break;case"fbx":o=new p.w;break;case"stl":o=new m.t;break;case"dae":o=new f.q;break;case"3ds":o=new v.b;break;case"ply":o=new b.Z;break;case"wrl":o=new g.F;break;default:return void console.error("Unsupported model file type")}o.load(e,(async o=>{let n;if(o.scene)n=o.scene;else if(o.isBufferGeometry){const e=new h._4j;n=new h.eaF(o,e)}else n=o;const a=5,i=new h.Pq0(0,0,-a);i.applyQuaternion(this.camera.quaternion),n.position.copy(this.camera.position).add(i),this.scene.add(n),this.objects.push({type:"model",url:e,extension:t,position:n.position.clone(),uuid:n.uuid}),await this.saveObjects()}))},saveObjects(){localStorage.setItem("threejs-objects",JSON.stringify(this.objects))},loadImageFromData(e){const t=new h.Tap,o=e.url.split(".").pop().toLowerCase();"gif"===o?this.loadGIF(e.url):t.load(e.url,(t=>{const o=t.image.width/t.image.height,n=new h.bdM(2,2/o),a=new h.V9B({map:t,side:h.$EB}),i=new h.eaF(n,a);i.position.copy(e.position),this.scene.add(i);const s=()=>{requestAnimationFrame(s),i.rotation.y+=.01};s()}))},loadAudioFromData(e){const t=new Audio(e.url),o=new h.iNn(.5,.5,.5),n=new h.V9B({color:65280}),a=new h.eaF(o,n);a.position.copy(e.position),a.userData={onClick:()=>t.play()},this.scene.add(a)},loadModelFromData(e){const t=new u.B;t.load(e.url,(t=>{t.scene.position.copy(e.position),this.scene.add(t.scene)}))},loadObjects(){const e=localStorage.getItem("threejs-objects");e&&(this.objects=JSON.parse(e),this.objects.forEach((e=>{switch(e.type){case"image":this.loadImageFromData(e);break;case"audio":this.loadAudioFromData(e);break;case"model":this.loadModelFromData(e);break}})))},clearObjects(){this.objects.forEach((e=>{const t=this.scene.getObjectByProperty("uuid",e.uuid);t&&this.scene.remove(t)})),this.objects=[],localStorage.removeItem("threejs-objects")}},beforeUnmount(){window.removeEventListener("resize",this.checkOrientation),window.removeEventListener("orientationchange",this.checkOrientation),document.removeEventListener("pointerlockerror",this.onPointerLockError),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("keydown",this.handleKeydown)}},j=o(6262);const F=(0,j.A)(k,[["render",d]]);var S=F;const E={class:"upload-menu"};function U(e,t,o,n,i,s){return(0,a.uX)(),(0,a.CE)("div",E,[(0,a.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...e)=>s.handleFileUpload&&s.handleFileUpload(...e))},null,32)])}var L={methods:{handleFileUpload(e){const t=e.target.files[0];this.$emit("upload",t)}}};const x=(0,j.A)(L,[["render",U]]);var A=x,M={name:"WhiteCubeRoom",components:{ThreeJSScene:S,UploadMenu:A},data(){return{showUploadMenu:!1}},mounted(){window.addEventListener("keydown",this.handleKeydown)},beforeUnmount(){window.removeEventListener("keydown",this.handleKeydown)},methods:{toggleUploadMenu(){this.showUploadMenu=!this.showUploadMenu,this.showUploadMenu?document.exitPointerLock():this.$refs.threeScene.controls&&!1===this.$refs.threeScene.controls.isLocked&&this.$refs.threeScene.controls.lock()},handleKeydown(e){switch(e.key.toLowerCase()){case"b":this.toggleUploadMenu();break;case"c":this.$refs.threeScene.clearObjects();break;default:break}},handleUpload(e){const t=10485760;if(e.size>t)return void alert("File size exceeds the limit of "+t/1024/1024+"MB.");const o=URL.createObjectURL(e),n=e.name.split(".").pop().toLowerCase();switch(n){case"jpg":case"jpeg":case"png":case"gif":this.$refs.threeScene.addImage(o);break;case"mp3":case"wav":this.$refs.threeScene.addAudio(o);break;case"gltf":case"glb":case"obj":case"fbx":case"stl":case"dae":case"3ds":case"ply":case"x3d":case"wrl":this.$refs.threeScene.addModel(o,n);break;default:console.error("Unsupported file type")}this.showUploadMenu=!1,this.$refs.threeScene.controls&&this.$refs.threeScene.controls.lock()}}};const O=(0,j.A)(M,[["render",r]]);var C=O,I={name:"App",components:{WhiteCubeRoom:C}};const B=(0,j.A)(I,[["render",s]]);var $=B;(0,n.Ef)($).mount("#app")},852:function(e,t,o){e.exports=o.p+"img/megaworld.f0fc96be.png"}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}o.m=e,function(){var e=[];o.O=function(t,n,a,i){if(!n){var s=1/0;for(h=0;h<e.length;h++){n=e[h][0],a=e[h][1],i=e[h][2];for(var r=!0,c=0;c<n.length;c++)(!1&i||s>=i)&&Object.keys(o.O).every((function(e){return o.O[e](n[c])}))?n.splice(c--,1):(r=!1,i<s&&(s=i));if(r){e.splice(h--,1);var d=a();void 0!==d&&(t=d)}}return t}i=i||0;for(var h=e.length;h>0&&e[h-1][2]>i;h--)e[h]=e[h-1];e[h]=[n,a,i]}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.p="/meganew/"}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,i,s=n[0],r=n[1],c=n[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(c)var h=c(o)}for(t&&t(n);d<s.length;d++)i=s[d],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(h)},n=self["webpackChunkmegatest"]=self["webpackChunkmegatest"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(7114)}));n=o.O(n)})();
//# sourceMappingURL=app.eb18cff2.js.map