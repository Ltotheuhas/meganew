(function(){"use strict";var e={9196:function(e,t,o){var n=o(3751),r=o(641);const i={id:"app"};function s(e,t,o,n,s,a){const c=(0,r.g2)("WhiteCubeRoom");return(0,r.uX)(),(0,r.CE)("div",i,[(0,r.bF)(c)])}function a(e,t,o,n,i,s){const a=(0,r.g2)("ThreeJSScene"),c=(0,r.g2)("UploadMenu");return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.bF)(a,{ref:"threeScene"},null,512),e.isMobile?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:t[0]||(t[0]=(...e)=>s.toggleUploadMenu&&s.toggleUploadMenu(...e))},"Upload Files")):(0,r.Q3)("",!0),i.showUploadMenu?((0,r.uX)(),(0,r.Wv)(c,{key:1,onUpload:s.handleUpload},null,8,["onUpload"])):(0,r.Q3)("",!0)])}o(4603),o(7566),o(8721);const c={ref:"threeContainer",class:"three-container"};function d(e,t,o,n,i,s){return(0,r.uX)(),(0,r.CE)("div",c,null,512)}o(4114);var h=o(9437),l=o(9318),u=o(2763),w=o(7070),p=o(3487),m=o(9702),f=o(6998),b=o(9502),v=o(5048),g=o(712),y={name:"ThreeJSScene",data(){return{move:{forward:!1,backward:!1,left:!1,right:!1},touchStart:{x:0,y:0},objects:[]}},mounted(){this.initThreeJS(),this.loadObjects()},methods:{initThreeJS(){const e=this.$refs.threeContainer,t=new h.Z58,n=new h.ubm(75,window.innerWidth/window.innerHeight,.1,1e3);n.rotation.order="YXZ";const r=new h.JeP;r.setSize(window.innerWidth,window.innerHeight),e.appendChild(r.domElement);const i=new h.$p8(16777215);t.add(i);const s=new h.fTw(20,20);t.add(s);const a=new h.IzY(5);t.add(a);const c=new h.iNn(10,10,10),d=new h.V9B({color:16777215,side:h.hsX}),u=new h.eaF(c,d);t.add(u);const w=new h.Tap;w.load(o(852),(e=>{const o=e.image.width/e.image.height,i=4,s=i/o,a=new h.bdM(i,s),c=new h.V9B({map:e,transparent:!0,side:h.$EB}),d=new h.eaF(a,c);d.position.set(0,2,0),t.add(d);const l=()=>{requestAnimationFrame(l),this.move.forward&&p.moveForward(.1),this.move.backward&&p.moveForward(-.1),this.move.left&&p.moveRight(-.1),this.move.right&&p.moveRight(.1),d.rotation.y+=.01,r.render(t,n)};l()}));const p=new l.Z(n,r.domElement);this.controls=p;const m=()=>{console.error("Pointer lock error occurred.")};document.addEventListener("pointerlockerror",m),document.addEventListener("click",(()=>p.lock()));const f=this.move,b=e=>{switch(e.code){case"ArrowUp":case"KeyW":f.forward=!0;break;case"ArrowDown":case"KeyS":f.backward=!0;break;case"ArrowLeft":case"KeyA":f.left=!0;break;case"ArrowRight":case"KeyD":f.right=!0;break}},v=e=>{switch(e.code){case"ArrowUp":case"KeyW":f.forward=!1;break;case"ArrowDown":case"KeyS":f.backward=!1;break;case"ArrowLeft":case"KeyA":f.left=!1;break;case"ArrowRight":case"KeyD":f.right=!1;break}};document.addEventListener("keydown",b),document.addEventListener("keyup",v);const g=e=>{this.touchStart.x=e.touches[0].clientX,this.touchStart.y=e.touches[0].clientY},y=e=>{const t=e.touches[0].clientX-this.touchStart.x,o=e.touches[0].clientY-this.touchStart.y;n.rotation.y-=.002*t,n.rotation.x-=.002*o,n.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,n.rotation.x)),this.touchStart.x=e.touches[0].clientX,this.touchStart.y=e.touches[0].clientY};document.addEventListener("touchstart",g),document.addEventListener("touchmove",y);const k=()=>{requestAnimationFrame(k),this.move.forward&&p.moveForward(.1),this.move.backward&&p.moveForward(-.1),this.move.left&&p.moveRight(-.1),this.move.right&&p.moveRight(.1),r.render(t,n)};k(),window.addEventListener("resize",(()=>{n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight)})),n.position.set(0,2,5),this.scene=t,this.camera=n,this.renderer=r},addImage(e){const t=new h.Tap;t.load(e,(t=>{const o=t.image.width/t.image.height,n=new h.bdM(2,2/o),r=new h.V9B({map:t,side:h.$EB}),i=new h.eaF(n,r),s=5,a=new h.Pq0(0,0,-s);a.applyQuaternion(this.camera.quaternion),i.position.copy(this.camera.position).add(a),i.lookAt(this.camera.position),this.scene.add(i),this.objects.push({type:"image",url:e,position:i.position.clone(),uuid:i.uuid}),this.saveObjects()}))},addAudio(e){const t=new Audio(e),o=new h.iNn(.5,.5,.5),n=new h.V9B({color:65280}),r=new h.eaF(o,n),i=5,s=new h.Pq0(0,0,-i);s.applyQuaternion(this.camera.quaternion),r.position.copy(this.camera.position).add(s),r.userData={onClick:()=>t.play()},this.scene.add(r),this.objects.push({type:"audio",url:e,position:r.position.clone(),uuid:r.uuid}),this.saveObjects()},addModel(e,t){let o;switch(t){case"gltf":case"glb":o=new u.B;break;case"obj":o=new w.L;break;case"fbx":o=new p.w;break;case"stl":o=new m.t;break;case"dae":o=new f.q;break;case"3ds":o=new b.b;break;case"ply":o=new v.Z;break;case"wrl":o=new g.F;break;default:return void console.error("Unsupported model file type")}o.load(e,(o=>{let n;if(o.scene)n=o.scene;else if(o.isBufferGeometry){const e=new h._4j;n=new h.eaF(o,e)}else n=o;const r=5,i=new h.Pq0(0,0,-r);i.applyQuaternion(this.camera.quaternion),n.position.copy(this.camera.position).add(i),this.scene.add(n),this.objects.push({type:"model",url:e,extension:t,position:n.position.clone(),uuid:n.uuid}),this.saveObjects()}))},saveObjects(){localStorage.setItem("threejs-objects",JSON.stringify(this.objects))},loadImageFromData(e){const t=new h.Tap;t.load(e.url,(t=>{const o=t.image.width/t.image.height,n=new h.bdM(2,2/o),r=new h.V9B({map:t,side:h.$EB}),i=new h.eaF(n,r);i.position.copy(e.position),this.scene.add(i);const s=()=>{requestAnimationFrame(s),i.rotation.y+=.01};s()}))},loadAudioFromData(e){const t=new Audio(e.url),o=new h.iNn(.5,.5,.5),n=new h.V9B({color:65280}),r=new h.eaF(o,n);r.position.copy(e.position),r.userData={onClick:()=>t.play()},this.scene.add(r)},loadModelFromData(e){const t=new u.B;t.load(e.url,(t=>{t.scene.position.copy(e.position),this.scene.add(t.scene)}))},loadObjects(){const e=localStorage.getItem("threejs-objects");e&&(this.objects=JSON.parse(e),this.objects.forEach((e=>{switch(e.type){case"image":this.loadImageFromData(e);break;case"audio":this.loadAudioFromData(e);break;case"model":this.loadModelFromData(e);break}})))},clearObjects(){this.objects.forEach((e=>{const t=this.scene.getObjectByProperty("uuid",e.uuid);t&&this.scene.remove(t)})),this.objects=[],localStorage.removeItem("threejs-objects")}},beforeUnmount(){window.removeEventListener("resize",this.checkOrientation),window.removeEventListener("orientationchange",this.checkOrientation),document.removeEventListener("pointerlockerror",this.onPointerLockError),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("keydown",this.handleKeydown)}},k=o(6262);const j=(0,k.A)(y,[["render",d]]);var S=j;const E={class:"upload-menu"};function U(e,t,o,n,i,s){return(0,r.uX)(),(0,r.CE)("div",E,[(0,r.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...e)=>s.handleFileUpload&&s.handleFileUpload(...e))},null,32)])}var F={methods:{handleFileUpload(e){const t=e.target.files[0];this.$emit("upload",t)}}};const L=(0,k.A)(F,[["render",U]]);var M=L,A={name:"WhiteCubeRoom",components:{ThreeJSScene:S,UploadMenu:M},data(){return{showUploadMenu:!1}},mounted(){window.addEventListener("keydown",this.handleKeydown)},beforeUnmount(){window.removeEventListener("keydown",this.handleKeydown)},methods:{toggleUploadMenu(){this.showUploadMenu=!this.showUploadMenu,this.showUploadMenu?document.exitPointerLock():this.$refs.threeScene.controls&&!1===this.$refs.threeScene.controls.isLocked&&this.$refs.threeScene.controls.lock()},handleKeydown(e){switch(e.key.toLowerCase()){case"u":this.toggleUploadMenu();break;case"c":this.$refs.threeScene.clearObjects();break;default:break}},handleUpload(e){const t=URL.createObjectURL(e),o=e.name.split(".").pop().toLowerCase();switch(o){case"jpg":case"jpeg":case"png":case"gif":this.$refs.threeScene.addImage(t);break;case"mp3":case"wav":this.$refs.threeScene.addAudio(t);break;case"gltf":case"glb":case"obj":case"fbx":case"stl":case"dae":case"3ds":case"ply":case"x3d":case"wrl":this.$refs.threeScene.addModel(t,o);break;default:console.error("Unsupported file type")}this.showUploadMenu=!1,this.$refs.threeScene.controls&&this.$refs.threeScene.controls.lock()}}};const O=(0,k.A)(A,[["render",a]]);var x=O,C={name:"App",components:{WhiteCubeRoom:x}};const $=(0,k.A)(C,[["render",s]]);var K=$;(0,n.Ef)(K).mount("#app")},852:function(e,t,o){e.exports=o.p+"img/megaworld.f0fc96be.png"}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,i){if(!n){var s=1/0;for(h=0;h<e.length;h++){n=e[h][0],r=e[h][1],i=e[h][2];for(var a=!0,c=0;c<n.length;c++)(!1&i||s>=i)&&Object.keys(o.O).every((function(e){return o.O[e](n[c])}))?n.splice(c--,1):(a=!1,i<s&&(s=i));if(a){e.splice(h--,1);var d=r();void 0!==d&&(t=d)}}return t}i=i||0;for(var h=e.length;h>0&&e[h-1][2]>i;h--)e[h]=e[h-1];e[h]=[n,r,i]}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.p="/meganew/"}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,i,s=n[0],a=n[1],c=n[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(c)var h=c(o)}for(t&&t(n);d<s.length;d++)i=s[d],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(h)},n=self["webpackChunkmegatest"]=self["webpackChunkmegatest"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(9196)}));n=o.O(n)})();
//# sourceMappingURL=app.cbd6c398.js.map